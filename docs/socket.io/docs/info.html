

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Docs &mdash; WebSockets Docs v2019.0613 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Rooms and namespaces" href="rooms-and-namespaces.html" />
    <link rel="prev" title="Docs" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../contents.html" class="icon icon-home"> WebSockets Docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">WebSockets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../awesome.html">Awesome WebSockets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">socket.io 文档</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../get-started/index.html">Get started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Docs</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Docs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-socket-io-is">What Socket.IO is</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-socket-io-is-not">What Socket.IO is not</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing">Installing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-with-node-http-server">Using with Node http server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-and-receiving-events">Sending and receiving events</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restricting-yourself-to-a-namespace">Restricting yourself to a namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-volatile-messages">Sending volatile messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-and-getting-data-acknowledgements">Sending and getting data (acknowledgements)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#broadcasting-messages">Broadcasting messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-it-just-as-a-cross-browser-websocket">Using it just as a cross-browser WebSocket</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rooms-and-namespaces.html">Rooms and namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="rooms-and-namespaces.html#rooms">Rooms</a></li>
<li class="toctree-l3"><a class="reference internal" href="rooms-and-namespaces.html#sending-messages-from-the-outside-world">Sending messages from the outside-world</a></li>
<li class="toctree-l3"><a class="reference internal" href="migrating-from-0-9.html">Migrating from 0.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="using-multiple-nodes.html">Using multiple nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging-and-debugging.html">Logging and debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="internals.html">Dependency graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="internals.html#under-the-hood">Under the hood</a></li>
<li class="toctree-l3"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="emit-cheatsheet.html">Emit cheatsheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="client-api.html">Client API</a></li>
<li class="toctree-l3"><a class="reference internal" href="client-api.html#manager">Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="client-api.html#socket">Socket</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-api.html">Server API</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-api.html#namespace">Namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-api.html#socket">Socket</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-api.html#client">Client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../demos/index.html">Demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_posts/index.html">发布历史</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">WebSockets Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">socket.io 文档</a> &raquo;</li>
        
          <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Docs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/socket.io/docs/info.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="docs">
<h1>Docs<a class="headerlink" href="#docs" title="永久链接至标题">¶</a></h1>
<div class="section" id="what-socket-io-is">
<h2>What Socket.IO is<a class="headerlink" href="#what-socket-io-is" title="永久链接至标题">¶</a></h2>
<p>Socket.IO is a library that enables real-time, bidirectional and
event-based communication between the browser and the server. It
consists of:</p>
<ul class="simple">
<li><p>a Node.js server: <a class="reference external" href="https://github.com/socketio/socket.io">Source</a>
| <a class="reference external" href="/docs/server-api/">API</a></p></li>
<li><p>a Javascript client library for the browser (which can be also run
from Node.js):
<a class="reference external" href="https://github.com/socketio/socket.io-client">Source</a> |
<a class="reference external" href="/docs/client-api/">API</a></p></li>
</ul>
<p>Its main features are:</p>
<div class="section" id="reliability">
<h3>Reliability<a class="headerlink" href="#reliability" title="永久链接至标题">¶</a></h3>
<p>Connections are established even in the presence of:</p>
<ul class="simple">
<li><p>proxies and load balancers.</p></li>
<li><p>personal firewall and antivirus software.</p></li>
</ul>
<p>For this purpose, it relies on
<a class="reference external" href="https://github.com/socketio/engine.io">Engine.IO</a>, which first
establishes a long-polling connection, then tries to upgrade to better
transports that are “tested” on the side, like WebSocket. Please see the
<a class="reference external" href="https://github.com/socketio/engine.io#goals">Goals</a> section for more
information.</p>
</div>
<div class="section" id="auto-reconnection-support">
<h3>Auto-reconnection support<a class="headerlink" href="#auto-reconnection-support" title="永久链接至标题">¶</a></h3>
<p>Unless instructed otherwise a disconnected client will try to reconnect
forever, until the server is available again. Please see the available
reconnection options
<a class="reference external" href="https://socket.io/docs/client-api/#new-Manager-url-options">here</a>.</p>
</div>
<div class="section" id="disconnection-detection">
<h3>Disconnection detection<a class="headerlink" href="#disconnection-detection" title="永久链接至标题">¶</a></h3>
<p>A heartbeat mechanism is implemented at the Engine.IO level, allowing
both the server and the client to know when the other one is not
responding anymore.</p>
<p>That functionality is achieved with timers set on both the server and
the client, with timeout values (the pingInterval and pingTimeout
parameters) shared during the connection handshake. Those timers require
any subsequent client calls to be directed to the same server, hence the
sticky-session requirement when using multiples nodes.</p>
</div>
<div class="section" id="binary-support">
<h3>Binary support<a class="headerlink" href="#binary-support" title="永久链接至标题">¶</a></h3>
<p>Any serializable data structures can be emitted, including:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">ArrayBuffer</a>
and <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Blob">Blob</a>
in the browser</p></li>
<li><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">ArrayBuffer</a>
and <a class="reference external" href="https://nodejs.org/api/buffer.html">Buffer</a> in Node.js</p></li>
</ul>
</div>
<div class="section" id="multiplexing-support">
<h3>Multiplexing support<a class="headerlink" href="#multiplexing-support" title="永久链接至标题">¶</a></h3>
<p>In order to create separation of concerns within your application (for
example per module, or based on permissions), Socket.IO allows you to
create several <a class="reference external" href="/docs/rooms-and-namespaces/#Namespaces">Namespaces</a>,
which will act as separate communication channels but will share the
same underlying connection.</p>
</div>
<div class="section" id="room-support">
<h3>Room support<a class="headerlink" href="#room-support" title="永久链接至标题">¶</a></h3>
<p>Within each <a class="reference external" href="/docs/rooms-and-namespaces/#Namespaces">Namespace</a>, you
can define arbitrary channels, called
<a class="reference external" href="/docs/rooms-and-namespaces/#Rooms">Rooms</a>, that sockets can join and
leave. You can then broadcast to any given room, reaching every socket
that has joined it.</p>
<p>This is a useful feature to send notifications to a group of users, or
to a given user connected on several devices for example.</p>
<p>Those features come with a simple and convenient API, which looks like
the following:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">socket</span><span class="p">){</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="cm">/* */</span><span class="p">);</span> <span class="c1">// emit an event to the socket</span>
  <span class="nx">io</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;broadcast&#39;</span><span class="p">,</span> <span class="cm">/* */</span><span class="p">);</span> <span class="c1">// emit an event to all connected sockets</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;reply&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="cm">/* */</span> <span class="p">});</span> <span class="c1">// listen to the event</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="what-socket-io-is-not">
<h2>What Socket.IO is not<a class="headerlink" href="#what-socket-io-is-not" title="永久链接至标题">¶</a></h2>
<p>Socket.IO is <strong>NOT</strong> a WebSocket implementation. Although Socket.IO
indeed uses WebSocket as a transport when possible, it adds some
metadata to each packet: the packet type, the namespace and the ack id
when a message acknowledgement is needed. That is why a WebSocket client
will not be able to successfully connect to a Socket.IO server, and a
Socket.IO client will not be able to connect to a WebSocket server
either. Please see the protocol specification
<a class="reference external" href="https://github.com/socketio/socket.io-protocol">here</a>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// WARNING: the client will NOT be able to connect!</span>
<span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">io</span><span class="p">(</span><span class="s1">&#39;ws://echo.websocket.org&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="永久链接至标题">¶</a></h2>
<div class="section" id="server">
<h3>Server<a class="headerlink" href="#server" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="nx">socket</span><span class="p">.</span><span class="nx">io</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/socketio/socket.io">Source</a></p>
</div>
<div class="section" id="javascript-client">
<h3>Javascript Client<a class="headerlink" href="#javascript-client" title="永久链接至标题">¶</a></h3>
<p>A standalone build of the client is exposed by default by the server at
<code class="docutils literal notranslate"><span class="pre">/socket.io/socket.io.js</span></code>.</p>
<p>It can also be served from a CDN, like
<a class="reference external" href="https://cdnjs.com/libraries/socket.io">cdnjs</a>.</p>
<p>To use it from Node.js, or with a bundler like
<a class="reference external" href="https://webpack.js.org/">webpack</a> or
<a class="reference external" href="http://browserify.org/">browserify</a>, you can also install the
package from npm:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="nx">socket</span><span class="p">.</span><span class="nx">io</span><span class="o">-</span><span class="nx">client</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/socketio/socket.io-client">Source</a></p>
</div>
<div class="section" id="other-client-implementations">
<h3>Other client implementations<a class="headerlink" href="#other-client-implementations" title="永久链接至标题">¶</a></h3>
<p>There are several client implementations in other languages, which are
maintained by the community:</p>
<ul class="simple">
<li><p>Java: <a class="reference external" href="https://github.com/socketio/socket.io-client-java">https://github.com/socketio/socket.io-client-java</a></p></li>
<li><p>C++: <a class="reference external" href="https://github.com/socketio/socket.io-client-cpp">https://github.com/socketio/socket.io-client-cpp</a></p></li>
<li><p>Swift: <a class="reference external" href="https://github.com/socketio/socket.io-client-swift">https://github.com/socketio/socket.io-client-swift</a></p></li>
<li><p>Dart: <a class="reference external" href="https://github.com/rikulo/socket.io-client-dart">https://github.com/rikulo/socket.io-client-dart</a></p></li>
<li><p>Python: <a class="reference external" href="https://github.com/miguelgrinberg/python-socketio">https://github.com/miguelgrinberg/python-socketio</a></p></li>
<li><p>.Net: <a class="reference external" href="https://github.com/Quobject/SocketIoClientDotNet">https://github.com/Quobject/SocketIoClientDotNet</a></p></li>
</ul>
</div>
</div>
<div class="section" id="using-with-node-http-server">
<h2>Using with Node http server<a class="headerlink" href="#using-with-node-http-server" title="永久链接至标题">¶</a></h2>
<div class="section" id="server-app-js">
<h3>Server (app.js)<a class="headerlink" href="#server-app-js" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">).</span><span class="nx">createServer</span><span class="p">(</span><span class="nx">handler</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="nx">app</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">handler</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/index.html&#39;</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Error loading index.html&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">hello</span><span class="o">:</span> <span class="s1">&#39;world&#39;</span> <span class="p">});</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;my other event&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="client-index-html">
<h3>Client (index.html)<a class="headerlink" href="#client-index-html" title="永久链接至标题">¶</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/socket.io/socket.io.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="kd">var</span> <span class="nx">socket</span> <span class="o">=</span> <span class="nx">io</span><span class="p">(</span><span class="s1">&#39;http://localhost&#39;</span><span class="p">);</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;my other event&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">my</span><span class="o">:</span> <span class="s1">&#39;data&#39;</span> <span class="p">});</span>
  <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>## Using with Express</p>
</div>
<div class="section" id="server-app-js-1">
<span id="id1"></span><h3>Server (app.js)<a class="headerlink" href="#server-app-js-1" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">)();</span>
<span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">).</span><span class="nx">Server</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="nx">server</span><span class="p">);</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>
<span class="c1">// WARNING: app.listen(80) will NOT work here!</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/index.html&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">hello</span><span class="o">:</span> <span class="s1">&#39;world&#39;</span> <span class="p">});</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;my other event&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="client-index-html-1">
<span id="id2"></span><h3>Client (index.html)<a class="headerlink" href="#client-index-html-1" title="永久链接至标题">¶</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/socket.io/socket.io.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="kd">var</span> <span class="nx">socket</span> <span class="o">=</span> <span class="nx">io</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost&#39;</span><span class="p">);</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;my other event&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">my</span><span class="o">:</span> <span class="s1">&#39;data&#39;</span> <span class="p">});</span>
  <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sending-and-receiving-events">
<h2>Sending and receiving events<a class="headerlink" href="#sending-and-receiving-events" title="永久链接至标题">¶</a></h2>
<p>Socket.IO allows you to emit and receive custom events. Besides
<code class="docutils literal notranslate"><span class="pre">connect</span></code>, <code class="docutils literal notranslate"><span class="pre">message</span></code> and <code class="docutils literal notranslate"><span class="pre">disconnect</span></code>, you can emit custom events:</p>
<div class="section" id="server-1">
<span id="id3"></span><h3>Server<a class="headerlink" href="#server-1" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// note, io(&lt;port&gt;) will create a http server for you</span>
<span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">io</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">will</span><span class="o">:</span> <span class="s1">&#39;be received by everyone&#39;</span><span class="p">});</span>

  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;private message&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">from</span><span class="p">,</span> <span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;I received a private message by &#39;</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="s1">&#39; saying &#39;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">io</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;user disconnected&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="restricting-yourself-to-a-namespace">
<h2>Restricting yourself to a namespace<a class="headerlink" href="#restricting-yourself-to-a-namespace" title="永久链接至标题">¶</a></h2>
<p>If you have control over all the messages and events emitted for a
particular application, using the default / namespace works. If you want
to leverage 3rd-party code, or produce code to share with others,
socket.io provides a way of namespacing a socket.</p>
<p>This has the benefit of <code class="docutils literal notranslate"><span class="pre">multiplexing</span></code> a single connection. Instead of
socket.io using two <code class="docutils literal notranslate"><span class="pre">WebSocket</span></code> connections, it’ll use one.</p>
<div class="section" id="server-app-js-2">
<span id="id4"></span><h3>Server (app.js)<a class="headerlink" href="#server-app-js-2" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">chat</span> <span class="o">=</span> <span class="nx">io</span>
  <span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="s1">&#39;/chat&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;a message&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">that</span><span class="o">:</span> <span class="s1">&#39;only&#39;</span>
      <span class="p">,</span> <span class="s1">&#39;/chat&#39;</span><span class="o">:</span> <span class="s1">&#39;will get&#39;</span>
    <span class="p">});</span>
    <span class="nx">chat</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;a message&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">everyone</span><span class="o">:</span> <span class="s1">&#39;in&#39;</span>
      <span class="p">,</span> <span class="s1">&#39;/chat&#39;</span><span class="o">:</span> <span class="s1">&#39;will get&#39;</span>
    <span class="p">});</span>
  <span class="p">});</span>

<span class="kd">var</span> <span class="nx">news</span> <span class="o">=</span> <span class="nx">io</span>
  <span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="s1">&#39;/news&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;item&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">news</span><span class="o">:</span> <span class="s1">&#39;item&#39;</span> <span class="p">});</span>
  <span class="p">});</span>
</pre></div>
</div>
<p>### Client (index.html)</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="kd">var</span> <span class="nx">chat</span> <span class="o">=</span> <span class="nx">io</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost/chat&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">news</span> <span class="o">=</span> <span class="nx">io</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost/news&#39;</span><span class="p">);</span>

  <span class="nx">chat</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">chat</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;hi!&#39;</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">news</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">news</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;woot&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sending-volatile-messages">
<h2>Sending volatile messages<a class="headerlink" href="#sending-volatile-messages" title="永久链接至标题">¶</a></h2>
<p>Sometimes certain messages can be dropped. Let’s say you have an app
that shows realtime tweets for the keyword <code class="docutils literal notranslate"><span class="pre">bieber</span></code>.</p>
<p>If a certain client is not ready to receive messages (because of network
slowness or other issues, or because they’re connected through long
polling and is in the middle of a request-response cycle), if it doesn’t
receive ALL the tweets related to bieber your application won’t suffer.</p>
<p>In that case, you might want to send those messages as volatile
messages.</p>
<p>### Server</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">tweets</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">getBieberTweet</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">socket</span><span class="p">.</span><span class="kr">volatile</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;bieber tweet&#39;</span><span class="p">,</span> <span class="nx">tweet</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>

  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">tweets</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-and-getting-data-acknowledgements">
<h2>Sending and getting data (acknowledgements)<a class="headerlink" href="#sending-and-getting-data-acknowledgements" title="永久链接至标题">¶</a></h2>
<p>Sometimes, you might want to get a callback when the client confirmed
the message reception.</p>
<p>To do this, simply pass a function as the last parameter of <code class="docutils literal notranslate"><span class="pre">.send</span></code> or
<code class="docutils literal notranslate"><span class="pre">.emit</span></code>. What’s more, when you use <code class="docutils literal notranslate"><span class="pre">.emit</span></code>, the acknowledgement is
done by you, which means you can also pass data along:</p>
<div class="section" id="server-app-js-3">
<span id="id5"></span><h3>Server (app.js)<a class="headerlink" href="#server-app-js-3" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;ferret&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fn</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; says &#39;</span> <span class="o">+</span> <span class="nx">word</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="client-index-html-2">
<span id="id6"></span><h3>Client (index.html)<a class="headerlink" href="#client-index-html-2" title="永久链接至标题">¶</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="kd">var</span> <span class="nx">socket</span> <span class="o">=</span> <span class="nx">io</span><span class="p">();</span> <span class="c1">// TIP: io() with no args does auto-discovery</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="c1">// TIP: you can avoid listening on `connect` and listen on events directly too!</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;ferret&#39;</span><span class="p">,</span> <span class="s1">&#39;tobi&#39;</span><span class="p">,</span> <span class="s1">&#39;woot&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// args are sent in order to acknowledgement function</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span> <span class="c1">// data will be &#39;tobi says woot&#39;</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="broadcasting-messages">
<h2>Broadcasting messages<a class="headerlink" href="#broadcasting-messages" title="永久链接至标题">¶</a></h2>
<p>To broadcast, simply add a <code class="docutils literal notranslate"><span class="pre">broadcast</span></code> flag to <code class="docutils literal notranslate"><span class="pre">emit</span></code> and <code class="docutils literal notranslate"><span class="pre">send</span></code>
method calls. Broadcasting means sending a message to everyone else
except for the socket that starts it.</p>
<div class="section" id="server-2">
<span id="id7"></span><h3>Server<a class="headerlink" href="#server-2" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">broadcast</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;user connected&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-it-just-as-a-cross-browser-websocket">
<h2>Using it just as a cross-browser WebSocket<a class="headerlink" href="#using-it-just-as-a-cross-browser-websocket" title="永久链接至标题">¶</a></h2>
<p>If you just want the WebSocket semantics, you can do that too. Simply
leverage <code class="docutils literal notranslate"><span class="pre">send</span></code> and listen on the <code class="docutils literal notranslate"><span class="pre">message</span></code> event:</p>
<div class="section" id="server-app-js-4">
<span id="id8"></span><h3>Server (app.js)<a class="headerlink" href="#server-app-js-4" title="永久链接至标题">¶</a></h3>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;socket.io&#39;</span><span class="p">)(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">socket</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="p">});</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="client-index-html-3">
<span id="id9"></span><h3>Client (index.html)<a class="headerlink" href="#client-index-html-3" title="永久链接至标题">¶</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="kd">var</span> <span class="nx">socket</span> <span class="o">=</span> <span class="nx">io</span><span class="p">(</span><span class="s1">&#39;http://localhost/&#39;</span><span class="p">);</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">);</span>

    <span class="nx">socket</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// my msg</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>If you don’t care about reconnection logic and such, take a look at
Engine.IO, which is the WebSocket semantics transport layer Socket.IO
uses.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rooms-and-namespaces.html" class="btn btn-neutral float-right" title="Rooms and namespaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, BandCap

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>